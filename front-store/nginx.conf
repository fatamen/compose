# ... (Nginx 全局配置，如 user, worker_processes 等保持不變)

http {
    # ... (http 塊內的通用配置保持不變)

    # HTTP (80 端口) Server - 重定向到 HTTPS
    server {
        listen       80;
        listen  [::]:80;
        # 這裡的 server_name 和重定向會不同，因為外部訪問會透過主機的 8081 端口進來
        # 但是容器內部仍然監聽 80 端口
        server_name  192.168.36.62; # <<< 請替換為您商店網站的實際 IP 地址或域名 (e.g., store.yourdomain.com)
        return 301 https://$host$request_uri;
    }

    # HTTPS (443 端口) Server
    server {
        listen       443 ssl;
        listen  [::]:443 ssl;
        # 這裡的 server_name 會不同，因為外部訪問會透過主機的 8443 端口進來
        server_name  192.168.36.62; # <<< 請替換為您商店網站的實際 IP 地址或域名

        ssl_certificate     /etc/nginx/certs/certificate.crt;
        ssl_certificate_key /etc/nginx/certs/private.key;
        # ... (SSL 基本配置保持不變)

        location /api/ {
            proxy_pass http://java:8080/;
            # ... (proxy_set_header 保持不變)
        }

        location / {
            root   /usr/share/nginx/html; # 此處指向 vue-store 的打包檔案
            index  index.html index.htm;
            try_files $uri $uri/ /index.html;
        }
        # ... (錯誤頁面配置保持不變)
    }

    # ... (如果需要，保留並配置 7173 端口服務)

    include /etc/nginx/conf.d/*.conf;
}